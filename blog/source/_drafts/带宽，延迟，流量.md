提到网络性能, 人们最关心的四个指标无非: 带宽, 延迟, 流量, 丢包率.  
(还有第五个: GFW).  
但你想过它们的本质是什么么?

带宽这个词, 总是让人联想到一条高速公路的宽度, 甚至一些业内人士也是这么解释的.  
但当你进一步追问"究竟有多宽?"的时候, 得到的答案却是一个速度, 比如 2M bis / s.

当提到Mibps, 我又想到了那纠结在很多人之间的换算问题, 为什么数据传输速度的单位会有两个? Mibps 和 MiB/s.  
在操作系统层面, 数据可控的最小单位是字节(Byte).  
而在网卡中, 数据需要被编码成数字信号(二进制的电信号或光信号), 这时, 数据的最小单位是比特(位, bit).  
虽然根据两者的定义很容易作出, 1 Mibps = 1/8 MiB/s 这样的转换。  
但这种转换的意义并不大. 在传输过程中, 底层会发送很多的控制指令和错误重传, 应用层也可能会使用压缩技术, 所以底层的信号发送速率并不能等价与应用层的传输速率。

当数据被编码成数字信号后, 便可以以极高的速度在线路中传输, 大概2/3光速. 可以说只要网卡能够将数字信号编码到网线中, 网线的传输速率是不存在瓶颈的。  
真正的瓶颈是网卡将数字信号编码成光/电信号的速度, 比如我们会看到网卡标注100 Mibps(个人电脑的典型配置), 那么就说明这个网卡每秒可以编码一亿个比特。

但为什么我们上网没享受到100 Mibps的速度呢，这是因为在从你的电脑，到与你通信的对方中间，有不止一台路由器。  
路由器也是计算机，只不过他们侧重于转发网络报文，他们编码数据的速率同样是有限的，如果收到数据的速率大于编码的速率，那么就会有一部分数据进入缓冲区进行排队，如果收到的数据更多，以至于缓冲区已经满了，那么它会开始丢弃新的数据，这时就发生了数据丢失(丢包).  

试想如果有两台路由器，编码速率分别为 100 Mibps 和 10 Mibps, 当前者向后者发送数据时，一旦速率大于 10 Mibps, 就会发生排队和丢包，因此

所以，事实上，网络延迟是由排队造成的，总延迟是数据在线路上所有路由器上排队时间的总和。  
而带宽取决于线路上编码速度最低的那台路由器，路由器通常是多人共享的，所以我指的是路由器为你提供的那份编码速率.
